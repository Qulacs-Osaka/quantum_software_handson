
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>古典コンピュータを使った量子化学計算を実行してみる &#8212; Quantum Software Hands on  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/05_01_conventional_quantum_chemical_calculations';</script>
    <link rel="canonical" href="https://qulacs-osaka.github.io/quantum_software_handson/notebooks/05_01_conventional_quantum_chemical_calculations.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="量子コンピュータ上に量子化学の問題をマッピングする" href="05_02_fermion_qubit_mapping.html" />
    <link rel="prev" title="擬確率法を実装してみる" href="04_03_Probabilistic_error_cancellation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/mark_type_jp_c.png" class="logo__image only-light" alt="Quantum Software Hands on  documentation - Home"/>
    <script>document.write(`<img src="../_static/mark_type_jp_c.png" class="logo__image only-dark" alt="Quantum Software Hands on  documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_01_how_to_use_qulacs.html">Qulacsの基本的な使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_02_Ramsay.html">ラムゼイ干渉をプロットする</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_03_VariationalGateDecomposition.html">変分法を用いて量子演算を特定の演算で分解する</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_04_QuantumVolume.html">ランダム量子回路と量子ボリューム</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_01_basics.html">期待値の推定</a></li>



<li class="toctree-l1"><a class="reference internal" href="02_02_quantum_simulation.html">量子シミュレーションのための量子アルゴリズム</a></li>



<li class="toctree-l1"><a class="reference internal" href="03_01_QCL.html">簡単な量子回路学習を実行してみる</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_02_quantum_kernel.html">量子カーネル法を使ってみる</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_01_Density_Matrix_and_Error.html">Qulacsでの混合状態</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_02_Extrapolation.html">リチャードソン外挿法と指数関数外挿法を実装してみる</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_03_Probabilistic_error_cancellation.html">擬確率法を実装してみる</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">古典コンピュータを使った量子化学計算を実行してみる</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_02_fermion_qubit_mapping.html">量子コンピュータ上に量子化学の問題をマッピングする</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_03_compute_groud_state_of_molecule_using_vqe.html">量子変分固有値法（VQE)を用いた基底状態計算</a></li>

<li class="toctree-l1"><a class="reference internal" href="05_04_compute_chemical_properties_using_Qamuy.html">Qamuyを使った量子コンピュータｘ量子化学計算</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_01_quantum_phase_estimation.html">位相推定アルゴリズム</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_02_grover_search.html">グローバー探索量子アルゴリズムをとことん実装する</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_DerivativePricing/07_01_DerivativePricing_blank.html">QAE を用いたデジタルオプションプライシング</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_01_Data_structure.html"><span class="math notranslate nohighlight">\(\mathrm{SQ}(A)\)</span>と<span class="math notranslate nohighlight">\(\mathrm{SQ}(b)\)</span>の実装について</a></li>





<li class="toctree-l1"><a class="reference internal" href="08_02_Quantum_inspired_classical_algorithm_Part1.html">行列<span class="math notranslate nohighlight">\(A\)</span>を定義する</a></li>







<li class="toctree-l1"><a class="reference internal" href="08_03_Quantum_inspired_classical_algorithm_Part2.html">(行列<span class="math notranslate nohighlight">\(C\)</span>の特異値分解の後)</a></li>



<li class="toctree-l1"><a class="reference internal" href="08_04_quantum_inspired_binary_classification.html">2クラス問題に対する量子インスパイアード古典アルゴリズム</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/05_01_conventional_quantum_chemical_calculations.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>古典コンピュータを使った量子化学計算を実行してみる</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#水素分子の計算（平均場近似と厳密対角化）">水素分子の計算（平均場近似と厳密対角化）</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#電子相関と電子相関エネルギー">電子相関と電子相関エネルギー</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#電子相関エネルギーと化学的精度">電子相関エネルギーと化学的精度</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#代表的なその他の量子化学計算手法">代表的なその他の量子化学計算手法</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pyscf
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>matplotlib
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found existing installation: h5py 3.4.0
Uninstalling h5py-3.4.0:
  Would remove:
    /usr/local/lib/python3.9/site-packages/h5py-3.4.0.dist-info/*
    /usr/local/lib/python3.9/site-packages/h5py/*
Proceed (y/n)?   Successfully uninstalled h5py-3.4.0
Requirement already satisfied: pyscf in /usr/local/lib/python3.9/site-packages (1.7.6)
Collecting h5py&gt;2.2
  Using cached h5py-3.4.0-cp39-cp39-macosx_10_9_x86_64.whl (3.0 MB)
Requirement already satisfied: numpy!=1.16,!=1.17,&gt;1.8 in /usr/local/lib/python3.9/site-packages (from pyscf) (1.20.3)
Requirement already satisfied: scipy!=1.5.0,!=1.5.1 in /usr/local/lib/python3.9/site-packages (from pyscf) (1.6.3)
Installing collected packages: h5py
Successfully installed h5py-3.4.0
<span class="ansi-yellow-fg">WARNING: You are using pip version 21.1.3; however, version 21.2.4 is available.
You should consider upgrading via the &#39;/usr/local/opt/python@3.9/bin/python3.9 -m pip install --upgrade pip&#39; command.</span>
Requirement already satisfied: matplotlib in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (3.4.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (from matplotlib) (2.8.1)
Requirement already satisfied: pillow&gt;=6.2.0 in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (from matplotlib) (8.2.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (from matplotlib) (2.4.7)
Requirement already satisfied: cycler&gt;=0.10 in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (from matplotlib) (0.10.0)
Requirement already satisfied: numpy&gt;=1.16 in /usr/local/lib/python3.9/site-packages (from matplotlib) (1.20.3)
Requirement already satisfied: six in /Users/yuichiro/Library/Python/3.9/lib/python/site-packages (from cycler&gt;=0.10-&gt;matplotlib) (1.15.0)
<span class="ansi-yellow-fg">WARNING: You are using pip version 21.1.3; however, version 21.2.4 is available.
You should consider upgrading via the &#39;/usr/local/opt/python@3.9/bin/python3.9 -m pip install --upgrade pip&#39; command.</span>
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">fci</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">cc</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">dft</span>
</pre></div>
</div>
</div>
<section id="古典コンピュータを使った量子化学計算を実行してみる">
<h1>古典コンピュータを使った量子化学計算を実行してみる<a class="headerlink" href="#古典コンピュータを使った量子化学計算を実行してみる" title="Link to this heading">#</a></h1>
<p>本勉強会の受講者には、量子化学計算に馴染みがない方も多いと思います。 そこで、まずは、「従来型」の量子化学計算に触れていただきます。</p>
<section id="水素分子の計算（平均場近似と厳密対角化）">
<h2>水素分子の計算（平均場近似と厳密対角化）<a class="headerlink" href="#水素分子の計算（平均場近似と厳密対角化）" title="Link to this heading">#</a></h2>
<p>ここでは、最も単純な分子である、水素分子(<span class="math notranslate nohighlight">\(H_2\)</span>)の基底状態を求めてみます。 ソフトウェアには、PySCFというプログラムを用います。 計算方法は、平均場近似（Hartree-Fock)法と、厳密対角化（化学ではFull CIという）をそれぞれ実行してみます。</p>
<p>また、通常の量子化学計算では、有限個のGauss型原子基底関数の線形結合で１電子波動関数（軌道）を記述します (Linear combination of atomic orbitals method, LCAO)。</p>
<div class="math notranslate nohighlight">
\[\psi_i(r) = \sum_{p} C_{ip}\xi_p(r)\]</div>
<p>この有限個の原子基底関数は、既に標準的に使われているものがいくつもあります。 今回は、その中でも最も単純な、STO-3Gという基底関数を使います。 STO-3Gでは、各水素原子にはそれぞれ１つのｓ型の軌道が使われています。 水素分子としては、２つの「空間」軌道があることになります。</p>
<div class="math notranslate nohighlight">
\[\xi_{1s}(r) = \sum_{i=1}^3 d_{i,1s}g_{1s}(a_i,r)\]</div>
<p>さて、電子にはスピンの自由度があるので、↑と↓のスピンの自由度ごとに空間軌道に電子が入ります。 スピンの自由度ごとに入る軌道をスピン軌道といいます。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\chi(x) =
\begin{cases}
\psi(r)\alpha(\omega) \\
\textrm{or} \\
\psi(r)\beta(\omega)
\end{cases}\end{split}\]</div>
<p>スピン軌道は空間軌道の２倍の数があります。STO-3G基底関数を使った場合、 水素分子には4つのスピン軌道があることになります。 水素には電子が２つあるので、電子があるスピンに存在する場合を１、しない場合を０としましょう。 すると、電子の詰まり方（電子配置は）、0011, 0101, 1001, 1100, 1010, 0110 の6パターンが存在することがわかります。</p>
<p>平均場近似では、電子の波動関数は一つのSlater行列式（一つの電子配置）であらわされます。 つまり、先程の６パターンうち１つの電子配置しか取らないと仮定して（例えば、0011)、 その仮定のもとでエネルギーが最小化される軌道を見つけます。</p>
<p>厳密対角化（Full CI)では、全ての取りうる電子配置を考えて、その重ね合わせで、 波動関数を表現します。</p>
<div class="math notranslate nohighlight">
\[|\Phi_{\textrm{CI}}\rangle = c_{0011}|\Psi_{0011}\rangle + c_{0101}|\Psi_{0101}\rangle + c_{1001}|\Psi_{1001}\rangle + c_{1100}|\Psi_{1100}\rangle + c_{1010}|\Psi_{1010}\rangle + c_{0110}|\Psi_{0110}\rangle\]</div>
<p>今回の例では電子配置の数は少ないですが、電子配置の数は組み合わせ爆発をおこしますので、 計算コストは指数関数的に増大します。</p>
<p>さて、まず平均場（Hartree-Fock）計算を実行してみましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 水素分子、H-H距離は0.74Å と設定。STO-3GというGaussian型の原子基底関数を使用。</span>
<span class="c1"># 3次元座標が(0, 0, 0)のHと、(0, 0, 0.74)のHを利用。</span>
<span class="n">mol_h2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;H 0 0 0; H 0 0 0.74&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
<span class="c1"># この水素分子の基底状態を平均場近似（Hartree-Fock theory)で計算してみる。</span>
<span class="n">mean_filed_wavefunction</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_h2</span><span class="p">)</span>
<span class="n">mean_filed_wavefunction</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">hf_energy</span> <span class="o">=</span> <span class="n">mean_filed_wavefunction</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Hartree-Fock Energy in (hartree)&quot;</span><span class="p">,</span> <span class="n">hf_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hartree-Fock Energy in (hartree) -1.1167593073964248
</pre></div></div>
</div>
<p>次に、厳密対角化（Full CI)の計算をおこないます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_ci_wavefunciton</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mean_filed_wavefunction</span><span class="p">)</span>
<span class="n">fci_energy</span><span class="p">,</span> <span class="n">fci_eigenvector</span> <span class="o">=</span> <span class="n">full_ci_wavefunciton</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Full CI Energy (in hartree)&quot;</span><span class="p">,</span> <span class="n">fci_energy</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Hartree Fock/Full CI Energy (in %)&quot;</span><span class="p">,</span> <span class="n">hf_energy</span><span class="o">/</span><span class="n">fci_energy</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Full CI Energy (in hartree) -1.1372838344885023
Hartree Fock/Full CI Energy (in %) 98.19530301322638
</pre></div></div>
</div>
</section>
<section id="電子相関と電子相関エネルギー">
<h2>電子相関と電子相関エネルギー<a class="headerlink" href="#電子相関と電子相関エネルギー" title="Link to this heading">#</a></h2>
<p>与えられたハミルトニアンに対する厳密解（Full CI)と平均場で解いたときのエネルギー（Hartree-Fockエネルギー）は、非常に近いことがわかる。平均場という単純な近似で、Full CIエネルギーの98.2%を再現している。一般におおよそ、Hartree-Fockは、全エネルギーの約99%を再現できると言われている。残りの約1%を電子相関エネルギーと呼ぶ。</p>
<p>この電子相関エネルギー(Electron Correlation Energy)を見てみよう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electron_correlation_energy</span> <span class="o">=</span> <span class="n">fci_energy</span> <span class="o">-</span> <span class="n">hf_energy</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Electron Correlation Energy in (hartree)&quot;</span><span class="p">,</span> <span class="n">electron_correlation_energy</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Electron Correlation Energy in (eV)&quot;</span><span class="p">,</span> <span class="n">electron_correlation_energy</span><span class="o">*</span><span class="mf">27.2114</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Electron Correlation Energy in (kcal/mol)&quot;</span><span class="p">,</span> <span class="n">electron_correlation_energy</span><span class="o">*</span><span class="mf">23.0605</span><span class="o">*</span><span class="mf">27.2114</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Electron Correlation Energy in (hartree) -0.020524527092077527
Electron Correlation Energy in (eV) -0.5585011165133584
Electron Correlation Energy in (kcal/mol) -12.879314997356303
</pre></div></div>
</div>
</section>
<section id="電子相関エネルギーと化学的精度">
<h2>電子相関エネルギーと化学的精度<a class="headerlink" href="#電子相関エネルギーと化学的精度" title="Link to this heading">#</a></h2>
<p>電子相関は、約0.56eV（13 kcal/mol)となっている。 さて、熱エネルギー（ボルツマン因子の逆数 <span class="math notranslate nohighlight">\(1/\beta = k_bT\)</span>; <span class="math notranslate nohighlight">\(k_b\)</span>はボルツマン定数）は、室温298.15Kで約0.026eV (0.59kcal/mol)である。 熱エネルギーと比べると、電子相関のエネルギーは非常に大きい値であることがわかる。</p>
<p>分子の安定性（存在比）や、化学反応速度は、状態間のエネルギー差を<span class="math notranslate nohighlight">\(\Delta E\)</span>とするとボルツマン分布<span class="math notranslate nohighlight">\(e^{-\beta \Delta E}\)</span>に比例し、エネルギー差に対して指数的に減少（増大）する。 +/- 0.56eV (13kcal/mol)ほど、<span class="math notranslate nohighlight">\(\Delta E\)</span>に誤差があるとすれば、正解となる反応速度を１としたときに、誤差に応じて以下のように大きく変動する。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;誤差が 0.56eVあったときの反応速度 </span><span class="si">%1.1e</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">np</span>.exp(-0.56/0.026))
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;誤差が-0.56eVあったときの反応速度 </span><span class="si">%1.1e</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">np</span>.exp(0.56/0.026))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
誤差が 0.56eVあったときの反応速度 4.4e-10
誤差が-0.56eVあったときの反応速度 2.3e+09
</pre></div></div>
</div>
<p>さて、誤差が 1kca/mol (約0.043eV)以下であった場合はどうだろう？</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;誤差が1kcal/mol(0.043eV)あったときの反応速度 </span><span class="si">%1.1e</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">np</span>.exp(-0.043/0.026))
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;誤差が1kcal/mol(-0.043V)あったときの反応速度 </span><span class="si">%1.1e</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">np</span>.exp(0.043/0.026))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
誤差が1kcal/mol(0.043eV)あったときの反応速度 1.9e-01
誤差が1kcal/mol(-0.043V)あったときの反応速度 5.2e+00
</pre></div></div>
</div>
<p>反応速度は、室温の場合、おおよそオーダーではあうことがわかる。 少なくとも、「反応速度（や存在比）のオーダーは予測できること」＝「化学における定量的計算」とするならば、量子化学の計算において目指すべき誤差はこの「1kcal/mol」となることがわかる。</p>
</section>
<section id="代表的なその他の量子化学計算手法">
<h2>代表的なその他の量子化学計算手法<a class="headerlink" href="#代表的なその他の量子化学計算手法" title="Link to this heading">#</a></h2>
<p>さて、では、計算の定量性を増すにはどうすればいいのだろうか？ 厳密にハミルトニアンを解く方法 Full CIは指数関数的な計算コストが必要となる。 このコストを下げるために、量子化学では、様々な近似理論が開発されてきた。 ここでは、計算コストが<span class="math notranslate nohighlight">\(O(N^5)\)</span>の二次の摂動論MP2、 現在の量子化学の「Golden standard」と称される<span class="math notranslate nohighlight">\(O(N^7)\)</span>の CCSD(T)、 そして、計算コストが<span class="math notranslate nohighlight">\(O(N^3)\)</span>で業界標準の方法となっているDFTという3つの手法を、 厳密な方法(Full CI)と比較してみよう。</p>
<p>水素分子は簡単過ぎるので、<span class="math notranslate nohighlight">\(H_4\)</span>という系を考えてみる。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">hf_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mp2_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ccsdt_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fci_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dft_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
  <span class="c1"># H4、H-H距離を変化。STO-3GというGaussian型の原子基底関数を使用。</span>
  <span class="n">r</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="mf">0.15</span>
  <span class="n">mol_h4</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;H 0 0 0; H 0 0 </span><span class="si">%f</span><span class="s1">; H 0 0 </span><span class="si">%f</span><span class="s1">; H 0 0 </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">r</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">r</span><span class="o">*</span><span class="mi">3</span><span class="p">),</span>
  <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
  <span class="c1"># この水素分子の基底状態を平均場近似（Hartree-Fock theory)で計算してみる。</span>
  <span class="n">mean_filed_wavefunction</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_h4</span><span class="p">)</span>
  <span class="n">mean_filed_wavefunction</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">hf_energy</span> <span class="o">=</span> <span class="n">mean_filed_wavefunction</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
  <span class="n">dft_wavefunction</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol_h4</span><span class="p">)</span>
  <span class="n">dft_wavefunction</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">dft_wavefunction</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;B3LYP&#39;</span>
  <span class="n">dft_energy</span> <span class="o">=</span> <span class="n">dft_wavefunction</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
  <span class="n">mp2_energy</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MP2</span><span class="p">(</span><span class="n">mean_filed_wavefunction</span><span class="p">)</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">hf_energy</span>
  <span class="n">ccsd_wavefunction</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RCCSD</span><span class="p">(</span><span class="n">mean_filed_wavefunction</span><span class="p">)</span>
  <span class="n">ccsd_wavefunction</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
  <span class="n">ccsdt_energy</span> <span class="o">=</span> <span class="n">ccsd_wavefunction</span><span class="o">.</span><span class="n">ccsd_t</span><span class="p">()</span> <span class="o">+</span> <span class="n">ccsd_wavefunction</span><span class="o">.</span><span class="n">e_tot</span>
  <span class="n">full_ci_wavefunciton</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mean_filed_wavefunction</span><span class="p">)</span>
  <span class="n">fci_energy</span><span class="p">,</span> <span class="n">fci_eigenvector</span> <span class="o">=</span> <span class="n">full_ci_wavefunciton</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
  <span class="n">hf_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hf_energy</span><span class="p">)</span>
  <span class="n">mp2_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp2_energy</span><span class="p">)</span>
  <span class="n">ccsdt_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">)</span>
  <span class="n">fci_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fci_energy</span><span class="p">)</span>
  <span class="n">dft_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dft_energy</span><span class="p">)</span>
  <span class="n">r_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_list</span><span class="p">,</span> <span class="n">hf_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_list</span><span class="p">,</span> <span class="n">mp2_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MP2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_list</span><span class="p">,</span> <span class="n">ccsdt_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CCSD(T)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_list</span><span class="p">,</span> <span class="n">fci_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Full CI&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_list</span><span class="p">,</span> <span class="n">dft_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DFT(B3LYP)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy in hartree&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;H-H distance in angstrom&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_01_conventional_quantum_chemical_calculations_15_0.png" src="../_images/notebooks_05_01_conventional_quantum_chemical_calculations_15_0.png" />
</div>
</div>
<p>DFTは、電子密度に依存する’ad hoc’なポテンシャルをHatree-Fockに導入した理論と捉えることができる。DFT自体は変分法であるが、この追加したポテンシャルのために、DFTのエネルギーの絶対値はFull CIの解よりも低いエネルギーを与えうる。</p>
<p>CCSD(T)は、H-Hの距離が長くなるところ（強相関領域）では、厳密解との乖離が大きくなるが、H-H距離が短いところではFull CIと良好な一致をしめしていることがわかる。</p>
<p>CCSD(T)は優れた理論であり、それ故に’Golden standard’と称されるわけだが、電子相関が強い領域で破綻する（もしくは精度が低下する）ことが知られている。 一般に電子相関が強い領域を定量的に記述することは大変であり、 満足のいく量子化学理論は未だに存在しない。</p>
<p>これが量子コンピュータに期待が集まる背景である。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="04_03_Probabilistic_error_cancellation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">擬確率法を実装してみる</p>
      </div>
    </a>
    <a class="right-next"
       href="05_02_fermion_qubit_mapping.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">量子コンピュータ上に量子化学の問題をマッピングする</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#水素分子の計算（平均場近似と厳密対角化）">水素分子の計算（平均場近似と厳密対角化）</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#電子相関と電子相関エネルギー">電子相関と電子相関エネルギー</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#電子相関エネルギーと化学的精度">電子相関エネルギーと化学的精度</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#代表的なその他の量子化学計算手法">代表的なその他の量子化学計算手法</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Qulacs-Osaka
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021, Qulacs-Osaka.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>