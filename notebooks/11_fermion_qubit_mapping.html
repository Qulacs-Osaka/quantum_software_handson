
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>量子コンピュータ上に量子化学の問題をマッピングする &#8212; Quantum Software Hands on  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="量子変分固有値法（VQE)を用いた基底状態計算" href="12_compute_groud_state_of_molecule_using_vqe.html" />
    <link rel="prev" title="古典コンピュータを使った量子化学計算を実行してみる" href="10_conventional_quantum_chemical_calculations.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Quantum Software Hands on  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_how_to_use_qulacs.html">
   Qulacsの基本的な使い方
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Ramsay.html">
   ラムゼイ干渉をプロットする
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_VariationalGateDecomposition.html">
   変分法を用いて量子演算を特定の演算で分解する
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_QuantumVolume.html">
   ランダム量子回路と量子ボリューム
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_sample_observable.html">
   サンプリングによってオブザーバブルの期待値を推定する
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_parameter_shift_rule.html">
   パラメータシフト法による勾配最適化
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_error_mitigation.html">
   エラー補償手法について学ぶ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_QCL.html">
   簡単な量子回路学習を実行してみる
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_quantum_kernel.html">
   量子カーネル法を使ってみる
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_conventional_quantum_chemical_calculations.html">
   古典コンピュータを使った量子化学計算を実行してみる
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   量子コンピュータ上に量子化学の問題をマッピングする
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_compute_groud_state_of_molecule_using_vqe.html">
   量子変分固有値法（VQE)を用いた基底状態計算
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_quantum_phase_estimation.html">
   位相推定アルゴリズム
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_grover_search.html">
   グローバー探索量子アルゴリズムをとことん実装する
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/11_fermion_qubit_mapping.ipynb.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#H_{qubit}を用意する手順">
   <span class="math notranslate nohighlight">
    \(H_{qubit}\)
   </span>
   を用意する手順
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#1.-計算する分子の構造や電荷など入力する">
     1. 計算する分子の構造や電荷など入力する
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#2.-平均場（Hartree-Fock）計算などを実行し(分子)軌道を得る">
     2. 平均場（Hartree-Fock）計算などを実行し(分子)軌道を得る
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#3.-得られた分子軌道から、第二量子化表現の電子のハミルトニアンH_{electron}を構築する">
     3. 得られた分子軌道から、第二量子化表現の電子のハミルトニアン
     <span class="math notranslate nohighlight">
      \(H_{electron}\)
     </span>
     を構築する
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#4.-OpenFermionなどを使って、H_{electron}をH_{qubit}に変換する">
     4. OpenFermionなどを使って、
     <span class="math notranslate nohighlight">
      \(H_{electron}\)
     </span>
     を
     <span class="math notranslate nohighlight">
      \(H_{qubit}\)
     </span>
     に変換する
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Jordan-Wigner-変換">
       Jordan-Wigner 変換
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Bravyi-Kitaev">
       Bravyi-Kitaev
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span>!echo y | pip uninstall h5py
!pip install h5py==2.9.0
!pip install openfermion openfermionpyscf
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Requirement already satisfied: openfermion in /usr/local/lib/python3.7/dist-packages (1.1.0)
Requirement already satisfied: openfermionpyscf in /usr/local/lib/python3.7/dist-packages (0.5)
Requirement already satisfied: deprecation in /usr/local/lib/python3.7/dist-packages (from openfermion) (2.1.0)
Requirement already satisfied: pubchempy in /usr/local/lib/python3.7/dist-packages (from openfermion) (1.0.4)
Requirement already satisfied: requests~=2.18 in /usr/local/lib/python3.7/dist-packages (from openfermion) (2.23.0)
Requirement already satisfied: sympy in /usr/local/lib/python3.7/dist-packages (from openfermion) (1.7.1)
Requirement already satisfied: nbformat in /usr/local/lib/python3.7/dist-packages (from openfermion) (5.1.3)
Requirement already satisfied: networkx in /usr/local/lib/python3.7/dist-packages (from openfermion) (2.6.2)
Requirement already satisfied: h5py&gt;=2.8 in /usr/local/lib/python3.7/dist-packages (from openfermion) (3.1.0)
Requirement already satisfied: numpy&gt;=1.11.0 in /usr/local/lib/python3.7/dist-packages (from openfermion) (1.19.5)
Requirement already satisfied: scipy&gt;=1.1.0 in /usr/local/lib/python3.7/dist-packages (from openfermion) (1.4.1)
Requirement already satisfied: cirq~=0.11.0 in /usr/local/lib/python3.7/dist-packages (from openfermion) (0.11.1)
Requirement already satisfied: cirq-google==0.11.1 in /usr/local/lib/python3.7/dist-packages (from cirq~=0.11.0-&gt;openfermion) (0.11.1)
Requirement already satisfied: cirq-core==0.11.1 in /usr/local/lib/python3.7/dist-packages (from cirq~=0.11.0-&gt;openfermion) (0.11.1)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (3.7.4.3)
Requirement already satisfied: sortedcontainers~=2.0 in /usr/local/lib/python3.7/dist-packages (from cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (2.4.0)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.1.5)
Requirement already satisfied: matplotlib~=3.0 in /usr/local/lib/python3.7/dist-packages (from cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (3.2.2)
Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (4.62.0)
Requirement already satisfied: protobuf~=3.13.0 in /usr/local/lib/python3.7/dist-packages (from cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (3.13.0)
Requirement already satisfied: google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0 in /usr/local/lib/python3.7/dist-packages (from cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.26.3)
Requirement already satisfied: google-auth&lt;2.0dev,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.34.0)
Requirement already satisfied: six&gt;=1.13.0 in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.15.0)
Requirement already satisfied: pytz in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (2018.9)
Requirement already satisfied: googleapis-common-protos&lt;2.0dev,&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.53.0)
Requirement already satisfied: packaging&gt;=14.3 in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (21.0)
Requirement already satisfied: setuptools&gt;=40.3.0 in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (57.4.0)
Requirement already satisfied: grpcio&lt;2.0dev,&gt;=1.29.0 in /usr/local/lib/python3.7/dist-packages (from google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.39.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2.0dev,&gt;=1.21.1-&gt;google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (4.7.2)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2.0dev,&gt;=1.21.1-&gt;google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (0.2.8)
Requirement already satisfied: cachetools&lt;5.0,&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2.0dev,&gt;=1.21.1-&gt;google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (4.2.2)
Requirement already satisfied: cached-property in /usr/local/lib/python3.7/dist-packages (from h5py&gt;=2.8-&gt;openfermion) (1.5.2)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib~=3.0-&gt;cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (2.4.7)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib~=3.0-&gt;cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (2.8.2)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib~=3.0-&gt;cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (0.10.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib~=3.0-&gt;cirq-core==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (1.3.1)
Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /usr/local/lib/python3.7/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;2.0dev,&gt;=1.21.1-&gt;google-api-core[grpc]&lt;2.0.0dev,&gt;=1.14.0-&gt;cirq-google==0.11.1-&gt;cirq~=0.11.0-&gt;openfermion) (0.4.8)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests~=2.18-&gt;openfermion) (1.24.3)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests~=2.18-&gt;openfermion) (3.0.4)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests~=2.18-&gt;openfermion) (2.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests~=2.18-&gt;openfermion) (2021.5.30)
Requirement already satisfied: pytest in /usr/local/lib/python3.7/dist-packages (from openfermionpyscf) (3.6.4)
Requirement already satisfied: pyscf in /usr/local/lib/python3.7/dist-packages (from openfermionpyscf) (1.7.6.post1)
Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from nbformat-&gt;openfermion) (2.6.0)
Requirement already satisfied: jupyter-core in /usr/local/lib/python3.7/dist-packages (from nbformat-&gt;openfermion) (4.7.1)
Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.7/dist-packages (from nbformat-&gt;openfermion) (0.2.0)
Requirement already satisfied: traitlets&gt;=4.1 in /usr/local/lib/python3.7/dist-packages (from nbformat-&gt;openfermion) (5.0.5)
Requirement already satisfied: py&gt;=1.5.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;openfermionpyscf) (1.10.0)
Requirement already satisfied: pluggy&lt;0.8,&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;openfermionpyscf) (0.7.1)
Requirement already satisfied: atomicwrites&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;openfermionpyscf) (1.4.0)
Requirement already satisfied: more-itertools&gt;=4.0.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;openfermionpyscf) (8.8.0)
Requirement already satisfied: attrs&gt;=17.4.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&gt;openfermionpyscf) (21.2.0)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/local/lib/python3.7/dist-packages (from sympy-&gt;openfermion) (1.2.1)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">openfermion.chem</span> <span class="kn">import</span> <span class="n">MolecularData</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">get_fermion_operator</span><span class="p">,</span> <span class="n">jordan_wigner</span><span class="p">,</span> <span class="n">bravyi_kitaev</span><span class="p">,</span> <span class="n">symmetry_conserving_bravyi_kitaev</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">get_sparse_operator</span>
<span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">FermionOperator</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">tools</span>
</pre></div>
</div>
</div>
<div class="section" id="量子コンピュータ上に量子化学の問題をマッピングする">
<h1>量子コンピュータ上に量子化学の問題をマッピングする<a class="headerlink" href="#量子コンピュータ上に量子化学の問題をマッピングする" title="Permalink to this headline">¶</a></h1>
<p>量子化学計算の基本は、分子の（電子に対する）波動関数<span class="math notranslate nohighlight">\(\Psi\)</span>を計算し、エネルギー E を得ることにある。 波動関数とエネルギーを得るには、以下の固有値方程式を解けばよい。</p>
<div class="math notranslate nohighlight">
\[H\Psi = E\Psi\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(H\)</span>は分子の（電子に対する）ハミルトニアンである。 また、量子力学の基本であるが、電子密度やDipole <span class="math notranslate nohighlight">\(\mu\)</span>などの物理量は演算子の期待値として計算される。</p>
<div class="math notranslate nohighlight">
\[\mu = \langle \Psi | \hat{\mu} | \Psi \rangle\]</div>
<p>この手続きを量子コンピュータでおこなうには、電子の波動関数<span class="math notranslate nohighlight">\(\Psi\)</span>とハミルトニアン<span class="math notranslate nohighlight">\(H\)</span>を量子コンピュータ上で量子回路を用いて表現する必要がある。ただ、第一原理ハミルニアンは、連続変数のハミルトニアンであり(e.g. 電子電子反発は<span class="math notranslate nohighlight">\(\frac{1}{r})\)</span>、これをそのまま量子コンピュータに載せることは難しい。そこで、デジタルコンピュータでの処理に適した、離散化された第二量子化表現のハミルトニアンを用いる。</p>
<div class="math notranslate nohighlight">
\[H_{electron} = \sum_{pq} T_{pq} c^\dagger_p c_q + \sum_{pqrs} V_{pqrs} c^\dagger_p c^\dagger_q  c_r c_s\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(c^\dagger_p\)</span>と<span class="math notranslate nohighlight">\(c_p\)</span>は、<span class="math notranslate nohighlight">\(p\)</span>番目の軌道に電子を生成させる生成演算子、<span class="math notranslate nohighlight">\(p\)</span>番目の軌道にある電子を消滅させる消滅演算子となっている。</p>
<p>残念がら、量子コンピュータは、スピン1/2の量子系であり、電子系（Fermion系）を直接サポートしていない。つまり、上記のハミルトニアンをそのまま量子コンピュータに載せることはできない。電子ハミルトニアン<span class="math notranslate nohighlight">\(H_{electron}\)</span> を量子コンピュータ上で取り扱うには、量子コンピュータに対応したqubit表現のハミルトニアン <span class="math notranslate nohighlight">\(H_{qubit}\)</span> へ変換しなくてはならない。</p>
<div class="math notranslate nohighlight">
\[H_{qubit} = \sum h_{p} P\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(P\)</span>と<span class="math notranslate nohighlight">\(p\)</span>は、パウリ演算子の積(e.g. XXYなど）とそれに対応するインデックスである。</p>
<p>この<span class="math notranslate nohighlight">\(H_{electron}\)</span>から<span class="math notranslate nohighlight">\(H_{qubit}\)</span>への変換法をこのチュートリアルでは見ていく。</p>
<div class="section" id="H_{qubit}を用意する手順">
<h2><span class="math notranslate nohighlight">\(H_{qubit}\)</span>を用意する手順<a class="headerlink" href="#H_{qubit}を用意する手順" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(H_{electron}\)</span>から<span class="math notranslate nohighlight">\(H_{qubit}\)</span>への変換法は、複数存在する。 実は、この変換は、今日では、既にオープンソースのソフトウェアを用いて簡単におこなえるようになっている。 そうしたソフトウェアとしては、IBMのQiskitやGoogleのチームが中心に開発しているOpenFermionが挙げられる。 このチュートリアルでは、OpenFermionを使うこととする。</p>
<p>量子コンピュータ用ハミルトニアンの用意は以下のステップでおこなわれる。 1. 計算する分子の構造や電荷など入力する （通常の量子化学計算と同じ） 2. 平均場（Hartree-Fock）計算などを実行し(分子)軌道を得る 3. 得られた分子軌道から、第二量子化表現の電子のハミルトニアン<span class="math notranslate nohighlight">\(H_{electron}\)</span>を構築する 4. OpenFermionなどを使って、<span class="math notranslate nohighlight">\(H_{electron}\)</span>を<span class="math notranslate nohighlight">\(H_{qubit}\)</span>に変換する</p>
<p>この各ステップについて以下で順に見ていきたい。</p>
<div class="section" id="1.-計算する分子の構造や電荷など入力する">
<h3>1. 計算する分子の構造や電荷など入力する<a class="headerlink" href="#1.-計算する分子の構造や電荷など入力する" title="Permalink to this headline">¶</a></h3>
<p>この部分については、通常の量子化学計算と同じである。 10_conventional_quantum_chemical_calculations で実行したのと同様に、 まずは水素分子を用意する。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># 水素分子、H-H距離は0.74Å と設定。STO-3GというGaussian型の原子基底関数を使用。</span>
<span class="n">mol_h2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;H 0 0 0; H 0 0 0.74&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.-平均場（Hartree-Fock）計算などを実行し(分子)軌道を得る">
<h3>2. 平均場（Hartree-Fock）計算などを実行し(分子)軌道を得る<a class="headerlink" href="#2.-平均場（Hartree-Fock）計算などを実行し(分子)軌道を得る" title="Permalink to this headline">¶</a></h3>
<p>この部分については、通常の量子化学計算と同じである。 量子化学計算では、</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># この水素分子の基底状態を平均場近似（Hartree-Fock theory)で計算してみる。</span>
<span class="n">mean_field_wavefunction</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_h2</span><span class="p">)</span>
<span class="n">mean_field_wavefunction</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">hf_energy</span> <span class="o">=</span> <span class="n">mean_field_wavefunction</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Hartree-Fock Energy in (hartree)&quot;</span><span class="p">,</span> <span class="n">hf_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hartree-Fock Energy in (hartree) -1.1167593073964248
</pre></div></div>
</div>
<p>Hartree-Fock計算を通して、変分的に最適な分子軌道(MO)を見つけることができる。 標準的な量子化学計算プログラムでは、Hartree-Fock計算とは、分子軌道<span class="math notranslate nohighlight">\(\phi^{MO}(r)\)</span>を原子基底<span class="math notranslate nohighlight">\(\chi^{AO}(r)\)</span>の線形結合で表すときに、その線形結合の係数（分子軌道係数, MO coefficients)を最適化する方法となっている。</p>
<div class="math notranslate nohighlight">
\[\phi^{MO}_{i}(r) = \sum_{p} C_{ip}\chi_{p}(r)\]</div>
<p>ここで、<span class="math notranslate nohighlight">\(i\)</span>はi番目の分子軌道を示し、<span class="math notranslate nohighlight">\(p\)</span>は原子軌道のindexである。<span class="math notranslate nohighlight">\(r\)</span>は、実空間の座標情報となっている。</p>
<p>この系は原子基底の数がわずか２つしかないので、得られた分子軌道をプリントして簡単に確認できる。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">mean_field_wavefunction</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Energy of the 1st MO&quot;</span><span class="p">,</span> <span class="n">mean_field_wavefunction</span><span class="o">.</span><span class="n">mo_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">mean_field_wavefunction</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Energy of the 2nd MO&quot;</span><span class="p">,</span> <span class="n">mean_field_wavefunction</span><span class="o">.</span><span class="n">mo_energy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
C0 [0.54884228 0.54884228] Energy of the 1st MO -0.5785538598315292
C1 [ 1.21245192 -1.21245192] Energy of the 2nd MO 0.6711434919142547
</pre></div></div>
</div>
</div>
<div class="section" id="3.-得られた分子軌道から、第二量子化表現の電子のハミルトニアンH_{electron}を構築する">
<h3>3. 得られた分子軌道から、第二量子化表現の電子のハミルトニアン<span class="math notranslate nohighlight">\(H_{electron}\)</span>を構築する<a class="headerlink" href="#3.-得られた分子軌道から、第二量子化表現の電子のハミルトニアンH_{electron}を構築する" title="Permalink to this headline">¶</a></h3>
<p>この部分については、通常の量子化学計算と同じである。 量子化学計算では、</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span>from qchem_util import get_molecular_hamiltonian_from_fcidump
# 第二量子化された電子のハミルトニアンを構築し、fcidump 形式で保存
tools.fcidump.from_scf(mean_field_wavefunction, &#39;fcidump.rhf&#39;)
#　保存した第二量子化ハミルトニアンを確認
!cat fcidump.rhf
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 &amp;FCI NORB=   2,NELEC= 2,MS2=0,
  ORBSYM=1,1,
  ISYM=1,
 &amp;END
 0.6747559268144482    1    1    1    1
 0.6637114013508137    1    1    2    2
 0.1812104620151971    2    1    2    1
 0.6637114013508137    2    2    1    1
 0.6976515044904633    2    2    2    2
 -1.253309786645977    1    1  0  0
 -0.4750688487721758    2    2  0  0
 0.7151043390810812  0  0  0  0
</pre></div></div>
</div>
<p>さて、fcidump.rhf の中身を見てみよう。 fcidumpには電子のハミルトニアン <span class="math notranslate nohighlight">\(H_{electron} = \sum_{pq} T_{pq} c^\dagger_p c_q + \sum_{pqrs} V_{pqrs} c^\dagger_p c^\dagger_q c_r c_s\)</span> の係数<span class="math notranslate nohighlight">\(T\)</span>と<span class="math notranslate nohighlight">\(V\)</span>の情報が以下のように記載されている。（注: fcidumpでは、インデックスの並びが <span class="math notranslate nohighlight">\(V_{psqr}\)</span>となっている）</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0.6747559268144482    1    1    1    1  ← V_{1111}
0.6637114013508137    1    1    2    2  ← V_{1221}
0.1812104620151971    2    1    2    1 ← V_{2211}
0.6637114013508137    2    2    1    1 ← V_{2112}
0.6976515044904633    2    2    2    2 ← V_{2222}
-1.253309786645977    1    1  0  0  ← T_{11}
-0.4750688487721758    2    2  0  0 ← T_{22}
0.7151043390810812  0  0  0  0 ← 定数
</pre></div>
</div>
<p>次に、OpenFermionプログラムをつかって、この第二量子化ハミルトニアンを確認してみよう。 出力された内容の見方であるが、以下の１行を例にとってみよう。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>((0, 1), (0, 1), (0, 0), (0, 0)) 0.3373779634072241
</pre></div>
</div>
<p>この場合、<span class="math notranslate nohighlight">\((0, 1)\)</span>は、<span class="math notranslate nohighlight">\(c^{\dagger}_0\)</span>という0番目の軌道に電子を生成する演算子を示しており、<span class="math notranslate nohighlight">\((0, 0)\)</span>は、<span class="math notranslate nohighlight">\(c_0\)</span>という0番目の軌道の電子を消去する演算子である。最後の数値が、<span class="math notranslate nohighlight">\(V_{0000}\)</span>に相当する。よって、この行は<span class="math notranslate nohighlight">\(V_{0000}c^{\dagger}_0c^{\dagger}_0c_0c_0\)</span>を意味している。fcidumpより、行数が多いのは、fcidumpは<span class="math notranslate nohighlight">\(V\)</span>や<span class="math notranslate nohighlight">\(T\)</span>に内在する対称性を活かして情報を圧縮しているからである。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">fermion_hamiltonian</span> <span class="o">=</span> <span class="n">get_molecular_hamiltonian_from_fcidump</span><span class="p">(</span><span class="s1">&#39;fcidump.rhf&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">fermion_hamiltonian</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parsing fcidump.rhf
() 0.7151043390810812
((0, 1), (0, 0)) -1.253309786645977
((1, 1), (1, 0)) -1.253309786645977
((2, 1), (2, 0)) -0.4750688487721758
((3, 1), (3, 0)) -0.4750688487721758
((0, 1), (0, 1), (0, 0), (0, 0)) 0.3373779634072241
((0, 1), (0, 1), (2, 0), (2, 0)) 0.09060523100759856
((0, 1), (1, 1), (1, 0), (0, 0)) 0.3373779634072241
((0, 1), (1, 1), (3, 0), (2, 0)) 0.09060523100759856
((0, 1), (2, 1), (0, 0), (2, 0)) 0.09060523100759856
((0, 1), (2, 1), (2, 0), (0, 0)) 0.3318557006754069
((0, 1), (3, 1), (1, 0), (2, 0)) 0.09060523100759856
((0, 1), (3, 1), (3, 0), (0, 0)) 0.3318557006754069
((1, 1), (0, 1), (0, 0), (1, 0)) 0.3373779634072241
((1, 1), (0, 1), (2, 0), (3, 0)) 0.09060523100759856
((1, 1), (1, 1), (1, 0), (1, 0)) 0.3373779634072241
((1, 1), (1, 1), (3, 0), (3, 0)) 0.09060523100759856
((1, 1), (2, 1), (0, 0), (3, 0)) 0.09060523100759856
((1, 1), (2, 1), (2, 0), (1, 0)) 0.3318557006754069
((1, 1), (3, 1), (1, 0), (3, 0)) 0.09060523100759856
((1, 1), (3, 1), (3, 0), (1, 0)) 0.3318557006754069
((2, 1), (0, 1), (0, 0), (2, 0)) 0.3318557006754069
((2, 1), (0, 1), (2, 0), (0, 0)) 0.09060523100759856
((2, 1), (1, 1), (1, 0), (2, 0)) 0.3318557006754069
((2, 1), (1, 1), (3, 0), (0, 0)) 0.09060523100759856
((2, 1), (2, 1), (0, 0), (0, 0)) 0.09060523100759856
((2, 1), (2, 1), (2, 0), (2, 0)) 0.34882575224523166
((2, 1), (3, 1), (1, 0), (0, 0)) 0.09060523100759856
((2, 1), (3, 1), (3, 0), (2, 0)) 0.34882575224523166
((3, 1), (0, 1), (0, 0), (3, 0)) 0.3318557006754069
((3, 1), (0, 1), (2, 0), (1, 0)) 0.09060523100759856
((3, 1), (1, 1), (1, 0), (3, 0)) 0.3318557006754069
((3, 1), (1, 1), (3, 0), (1, 0)) 0.09060523100759856
((3, 1), (2, 1), (0, 0), (1, 0)) 0.09060523100759856
((3, 1), (2, 1), (2, 0), (3, 0)) 0.34882575224523166
((3, 1), (3, 1), (1, 0), (1, 0)) 0.09060523100759856
((3, 1), (3, 1), (3, 0), (3, 0)) 0.34882575224523166

</pre></div></div>
</div>
</div>
<div class="section" id="4.-OpenFermionなどを使って、H_{electron}をH_{qubit}に変換する">
<h3>4. OpenFermionなどを使って、<span class="math notranslate nohighlight">\(H_{electron}\)</span>を<span class="math notranslate nohighlight">\(H_{qubit}\)</span>に変換する<a class="headerlink" href="#4.-OpenFermionなどを使って、H_{electron}をH_{qubit}に変換する" title="Permalink to this headline">¶</a></h3>
<p>ここまでで、<span class="math notranslate nohighlight">\(H_{electron}\)</span>が計算できたので、最後に<span class="math notranslate nohighlight">\(H_{qubit}\)</span>への変換をおこなう。 この変換方法はいくつかある。代表的なものを３つあげよう。 1. Jordan-Wigner変換 2. Parity変換 3. Bravyi-Kitaev変換 本演習では、以下で1と3の2つの変換法を見てみる。</p>
<div class="section" id="Jordan-Wigner-変換">
<h4>Jordan-Wigner 変換<a class="headerlink" href="#Jordan-Wigner-変換" title="Permalink to this headline">¶</a></h4>
<p>Jordan-Wigner変換は、最も直感的な変換である。 一つ一つの量子ビットをスピン分子軌道に対応させ、0だと、電子が詰まっておらず、1だと電子が詰まっていると考える。例えば、0011 だと、右から1番目の軌道と、右から2番目の軌道に電子が入っている電子状態を示している。</p>
<p>この占有数の情報を変更するのが、<span class="math notranslate nohighlight">\(c^\dagger_i\)</span>、<span class="math notranslate nohighlight">\(c_i\)</span>なのだから、同じことをパウリ演算子で、できるようになれば良い。パウリ演算子を使って定義される以下の演算子は、あるqubit（=軌道）の値を0から1に、1から0に変更できる</p>
<div class="math notranslate nohighlight">
\[P_{+} =  \frac{X-iY}{2}\]</div>
<div class="math notranslate nohighlight">
\[P_{-} =  \frac{X+iY}{2}\]</div>
<p>しかしながら、この２つの演算子はフェルミオン（電子）の演算子の交換関係<span class="math notranslate nohighlight">\([c^\dagger_p,c_q]=\delta_{pq}\)</span>を満たさない。これは、<span class="math notranslate nohighlight">\(P_{+/-}\)</span>にフェルミンの特徴である、粒子の交換に対する反対称性がエンコードされていないためである。フェルミオンの波動関数はよく知らているように、粒子の交換に対して符号が変わるという性質を持っている。この性質は、<span class="math notranslate nohighlight">\(P_{+/-,i}\)</span>が作用するサイト（軌道）より前にいくつ電子があるかを数えればわかる。これは、<span class="math notranslate nohighlight">\(i\)</span>より前のサイトに<span class="math notranslate nohighlight">\(Z\)</span>をかけていけばわかる。</p>
<div class="math notranslate nohighlight">
\[Q_i=\prod_{j &lt; i} Z_j\]</div>
<p><span class="math notranslate nohighlight">\(Q_i\)</span>は、電子が<span class="math notranslate nohighlight">\(i\)</span>より前に偶数個あれば、交換を偶数会繰り返すので、符号は変えず、奇数個であれば、符号を変化させる。この<span class="math notranslate nohighlight">\(Q_i\)</span>と、<span class="math notranslate nohighlight">\(P_{+/-}\)</span>を組み合わせれば、<span class="math notranslate nohighlight">\(c^{\dagger}_p\)</span>,<span class="math notranslate nohighlight">\(c_p\)</span>と一対一で対応する演算子をパウリ演算子を使って構築できる。</p>
<div class="math notranslate nohighlight">
\[c^{\dagger}_p = P_{+,i}Q_{i}\]</div>
<p>では、この変換をOpenFermionを使って実行してみよう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">jw_qubit_hamiltonian</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">get_fermion_operator</span><span class="p">(</span><span class="n">fermion_hamiltonian</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">jw_qubit_hamiltonian</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-0.09706626816762849+0j) [] +
(-0.04530261550379928+0j) [X0 X1 Y2 Y3] +
(0.04530261550379928+0j) [X0 Y1 Y2 X3] +
(0.04530261550379928+0j) [Y0 X1 X2 Y3] +
(-0.04530261550379928+0j) [Y0 Y1 X2 X3] +
(0.1714128264477689+0j) [Z0] +
(0.16868898170361205+0j) [Z0 Z1] +
(0.12062523483390417+0j) [Z0 Z2] +
(0.16592785033770344+0j) [Z0 Z3] +
(0.17141282644776892+0j) [Z1] +
(0.16592785033770344+0j) [Z1 Z2] +
(0.12062523483390417+0j) [Z1 Z3] +
(-0.2234315369081355+0j) [Z2] +
(0.17441287612261583+0j) [Z2 Z3] +
(-0.2234315369081355+0j) [Z3]
</pre></div></div>
</div>
<p>Jordan-Wigner変換のメリットは、占有数表示という我々の理解しやすい描像を保ったまま、Hamiltonianを変換できる点にある。 デメリットとしては、<span class="math notranslate nohighlight">\(O(N)\)</span>の長さを持つパウリ演算子の積が現れることである。 <span class="math notranslate nohighlight">\(H_{electron}\)</span>は<span class="math notranslate nohighlight">\(O(N^4)\)</span>のタームがあるため、<span class="math notranslate nohighlight">\(H_{qubit}\)</span>に現れるハミルトニアンをパウリ演算子の数は<span class="math notranslate nohighlight">\(O(N^5)\)</span>となる。</p>
</div>
<div class="section" id="Bravyi-Kitaev">
<h4>Bravyi-Kitaev<a class="headerlink" href="#Bravyi-Kitaev" title="Permalink to this headline">¶</a></h4>
<p>詳細は省くが、Bravyi-Kitaev変換は、我々の理解しやすい占有数表示から離れることで、 フェルミオンの演算子を表すのに必要なパウリ演算子の数を<span class="math notranslate nohighlight">\(O(logN)\)</span>に減らすことができる方法となっている。 このBravyi-Kitaev変換を実行してみよう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">bk_qubit_hamiltonian</span> <span class="o">=</span> <span class="n">bravyi_kitaev</span><span class="p">(</span><span class="n">get_fermion_operator</span><span class="p">(</span><span class="n">fermion_hamiltonian</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">bk_qubit_hamiltonian</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-0.09706626816762849+0j) [] +
(0.04530261550379928+0j) [X0 Z1 X2] +
(0.04530261550379928+0j) [X0 Z1 X2 Z3] +
(0.04530261550379928+0j) [Y0 Z1 Y2] +
(0.04530261550379928+0j) [Y0 Z1 Y2 Z3] +
(0.1714128264477689+0j) [Z0] +
(0.17141282644776892+0j) [Z0 Z1] +
(0.16592785033770344+0j) [Z0 Z1 Z2] +
(0.16592785033770344+0j) [Z0 Z1 Z2 Z3] +
(0.12062523483390417+0j) [Z0 Z2] +
(0.12062523483390417+0j) [Z0 Z2 Z3] +
(0.16868898170361205+0j) [Z1] +
(-0.2234315369081355+0j) [Z1 Z2 Z3] +
(0.17441287612261583+0j) [Z1 Z3] +
(-0.2234315369081355+0j) [Z2]
</pre></div></div>
</div>
<p>この系が非常に小さいため、Jordan-Wigner変換と大きな違いは見えないが、4体のパウリ演算子からなる項が一つ減っていることがわかる。</p>
<p>また、この変換の際に、粒子数やSzなどの量子数の保存を考慮すると、それぞれの自由度に応じて、必要な量子ビット数を一つずつ、系二個減らすことができる。(Qubit tapering) この対称性を考慮した変換を実行してみよう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">active_orbitals</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">active_fermions</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">symmetry_conserving_bravyi_kitaev</span><span class="p">(</span><span class="n">get_fermion_operator</span><span class="p">(</span><span class="n">fermion_hamiltonian</span><span class="p">),</span><span class="n">active_orbitals</span><span class="p">,</span><span class="n">active_fermions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-0.3383167378354368 [] +
0.1812104620151971 [X0 X1] +
0.3948443633559044 [Z0] +
0.011246157150821001 [Z0 Z1] +
0.39484436335590445 [Z1]
</pre></div></div>
</div>
<p>この系はもともと4qubitしか使っていなかったこともあり、2個qubit減ることで、大幅にシンプルなハミルトニアンが得られている</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="10_conventional_quantum_chemical_calculations.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">古典コンピュータを使った量子化学計算を実行してみる</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="12_compute_groud_state_of_molecule_using_vqe.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">量子変分固有値法（VQE)を用いた基底状態計算</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Qulacs-Osaka<br/>
        
            &copy; Copyright 2021, Qulacs-Osaka.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>